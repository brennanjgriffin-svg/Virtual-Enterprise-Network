# Runbook: Configuring Windows Connection

## Overview
This runbook outlines the initial configuration of the Windows Server after installation in the Virtual Enterprise Network project.  
It includes assigning static ipv4 address, DNS server and backup, and enabling DHCP.

## Prerequisites

- OPNsense VM installed and booted
- Hyper V networks created:
  - `WAN_Switch`
  - `MGMT_Switch`
  - `INTERNAL_Switch`
  - `GUEST_Switch`
  - Optional: Additional adapters for additional subnets. 
- Network plan documented (e.g., `ip-plan.md`)

---
### Related Documents
 - 
---
## Procedure

### 1. Configure Network adapter

1. In powered down state navigate to Windows Server Machine settings

2. In Hardware settings 
  - Choose network adapter
  - Choose appropriate Virual Switch according to ip-plan.md (eg. 'MGMT_Switch', 'INTERNAL_VLANS_Switch', 'DMZ_Switch', 'GUEST_Switch'
  - Click okay

3. Boot  VM

4. Log into Powershell and verify adapter
  - Right click Windows icon and select 'Terminal (Admin)'
  - Enter 'Get-NetAdapter'
   - Verify adapter is running
   - Note Adapter Name 'eg. Ethernet'


5. Configure static ipv4 address.
  -In Terminal, run 'New-NetIPAddress -InterfaceAlias "[Noted adapter name 'eg. Ethernet']" -AddressFamily IPv4 -IPAddress "10.0.10.2" -PrefixLength 24 -DefaultGateway "10.0.10.1"

6. Disable IPv6
  -In Terminal, run 'Disable-NetAdapterBinding -Name "Ethernet" -ComponentID ms_tcpip6'

7. Verify Connection to Firewall and Gateway
   - In terminal 'ping 10.0.10.1' (Firewall)
    - **Expected Result:** sucessful ping
   - In terminal 'ping 8.8.8.8' (External ipv4 'eg. google.com')
    - *Expected Result:** sucessful ping

### 2. Configure DNS

1. In Terminal, enter 'Set-DnsClientServerAddress -InterfaceAlias "Ethernet" -ServerAddresses ("10.0.10.2","10.0.10.1")'

2. Verify DNS
  -In terminal,'Get-DnsClientServerAddress'
   - **Expected Result:** DNS servers (10.0.10.11, 10.0.20.12)
  - Ping 'google.com'
   - **Expected Result:** sucessful ping
